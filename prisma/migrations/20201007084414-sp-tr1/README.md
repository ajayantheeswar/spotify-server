# Migration `20201007084414-sp-tr1`

This migration has been generated by ajayantheeswar at 10/7/2020, 2:14:14 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."album" DROP CONSTRAINT "album_lang_fk"

ALTER TABLE "public"."album" DROP CONSTRAINT "album_fk"

ALTER TABLE "public"."playlist" DROP CONSTRAINT "playlist_fk"

ALTER TABLE "public"."track" DROP CONSTRAINT "track_fk"

ALTER TABLE "public"."track" DROP CONSTRAINT "track_gerne_fk"

ALTER TABLE "public"."track_artist" DROP CONSTRAINT "track_artist_fk_1"

ALTER TABLE "public"."track_artist" DROP CONSTRAINT "track_artist_fk"

ALTER TABLE "public"."track_playlist" DROP CONSTRAINT "track_playlist_fk1"

ALTER TABLE "public"."track_playlist" DROP CONSTRAINT "track_playlist_fk"

ALTER TABLE "public"."album" DROP CONSTRAINT "album_pk",
DROP COLUMN "id",
ADD COLUMN "id" text   NOT NULL ,
DROP COLUMN "music_director",
ADD COLUMN "music_director" text   ,
DROP COLUMN "language",
ADD COLUMN "language" text   ,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."artist" DROP CONSTRAINT "artist_pk",
DROP COLUMN "id",
ADD COLUMN "id" text   NOT NULL ,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."gerne" DROP CONSTRAINT "gerne_pk",
DROP COLUMN "id",
ADD COLUMN "id" text   NOT NULL ,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."language" DROP CONSTRAINT "language_pk",
DROP COLUMN "id",
ADD COLUMN "id" text   NOT NULL ,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."playlist" DROP CONSTRAINT "playlist_pk",
DROP COLUMN "id",
ADD COLUMN "id" text   NOT NULL ,
DROP COLUMN "userid",
ADD COLUMN "userid" text   NOT NULL ,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."track" DROP CONSTRAINT "track_pk",
DROP COLUMN "id",
ADD COLUMN "id" text   NOT NULL ,
DROP COLUMN "albumn_id",
ADD COLUMN "albumn_id" text   ,
DROP COLUMN "gerne",
ADD COLUMN "gerne" text   ,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."track_artist" DROP CONSTRAINT "track_artist_pk",
DROP COLUMN "id",
ADD COLUMN "id" text   NOT NULL ,
DROP COLUMN "track_id",
ADD COLUMN "track_id" text   NOT NULL ,
DROP COLUMN "artist_id",
ADD COLUMN "artist_id" text   NOT NULL ,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."track_playlist" DROP CONSTRAINT "track_playlist_pk",
DROP COLUMN "id",
ADD COLUMN "id" text   NOT NULL ,
DROP COLUMN "playlist_id",
ADD COLUMN "playlist_id" text   NOT NULL ,
DROP COLUMN "track_id",
ADD COLUMN "track_id" text   NOT NULL ,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."users" DROP CONSTRAINT "newtable_pk",
DROP COLUMN "id",
ADD COLUMN "id" text   NOT NULL ,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."album" ADD FOREIGN KEY ("language")REFERENCES "public"."language"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."album" ADD FOREIGN KEY ("music_director")REFERENCES "public"."artist"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."playlist" ADD FOREIGN KEY ("userid")REFERENCES "public"."users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."track" ADD FOREIGN KEY ("albumn_id")REFERENCES "public"."album"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."track" ADD FOREIGN KEY ("gerne")REFERENCES "public"."gerne"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."track_artist" ADD FOREIGN KEY ("artist_id")REFERENCES "public"."artist"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."track_artist" ADD FOREIGN KEY ("track_id")REFERENCES "public"."track"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."track_playlist" ADD FOREIGN KEY ("playlist_id")REFERENCES "public"."playlist"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."track_playlist" ADD FOREIGN KEY ("track_id")REFERENCES "public"."track"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER INDEX "public"."users_un" RENAME TO "users.email_unique"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201007084414-sp-tr1
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,86 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model users {
+  id       String     @id @default(uuid())
+  email    String     @unique
+  authtype String
+  password String
+  dob      DateTime
+  gender   String
+  name     String
+  playlist playlist[]
+}
+
+model album {
+  id                       String    @id @default(uuid())
+  album_name               String
+  image_url                String?
+  music_director           String?
+  language                 String?
+  language_albumTolanguage language? @relation(fields: [language], references: [id])
+  artist                   artist?   @relation(fields: [music_director], references: [id])
+  track                    track[]
+}
+
+model artist {
+  id           String         @id @default(uuid())
+  artist_name  String
+  album        album[]
+  track_artist track_artist[]
+}
+
+model track {
+  id                 String           @id @default(uuid())
+  track_name         String
+  track_url          String
+  image_url          String?
+  albumn_id          String?
+  gerne              String?
+  album              album?           @relation(fields: [albumn_id], references: [id])
+  gerne_gerneTotrack gerne?           @relation(fields: [gerne], references: [id])
+  track_artist       track_artist[]
+  track_playlist     track_playlist[]
+}
+
+model track_artist {
+  id        String @id @default(uuid())
+  track_id  String
+  artist_id String
+  artist    artist @relation(fields: [artist_id], references: [id])
+  track     track  @relation(fields: [track_id], references: [id])
+}
+
+model gerne {
+  id         String  @id @default(uuid())
+  gerne_name String
+  track      track[]
+}
+
+model language {
+  id       String  @id @default(uuid())
+  language String
+  album    album[]
+}
+
+model playlist {
+  id             String           @id @default(uuid())
+  name           String
+  userid         String
+  users          users            @relation(fields: [userid], references: [id])
+  track_playlist track_playlist[]
+}
+
+model track_playlist {
+  id          String   @id @default(uuid())
+  playlist_id String
+  track_id    String
+  playlist    playlist @relation(fields: [playlist_id], references: [id])
+  track       track    @relation(fields: [track_id], references: [id])
+}
```


